  There is still a problem left with this code: the boundary
  conditions from the original, global, version have not been taken
  into account. Give code that solves that problem.
